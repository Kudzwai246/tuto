<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Apply as Teacher — Tuto</title>

  <!-- Link to your existing CSS -->
  <link rel="stylesheet" href="css/style.css" />

  <!-- Google Font (Inter) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
    rel="stylesheet"
  />

  <!-- Additional CSS for this page -->
  <style>
    :root {
      --input-bg: #2a2a2a;
      --input-border: #444;
      --input-focus-border: var(--accent);
      --card-bg: #1f1f1f;
    }
    /* ===== Mini-hero adjustments ===== */
    .mini-hero .hero-content {
      padding: 1rem;
    }
    .mini-hero .hero-title {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }
    .mini-hero .hero-subtitle {
      font-size: 1rem;
      opacity: 0.8;
      max-width: 600px;
      margin: 0 auto;
    }

    /* ===== Application Card ===== */
    .application-card {
      background-color: var(--card-bg);
      border-radius: 10px;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
      padding: 2.5rem 2rem;
      max-width: 600px;
      margin: 2rem auto;
      animation: fadeInUp 0.8s ease-out forwards;
    }
    .application-card h2 {
      font-size: 1.75rem;
      font-weight: 600;
      color: var(--text-light);
      margin-bottom: 1.5rem;
      text-align: center;
    }
    .application-form .form-group {
      margin-bottom: 1.75rem;
    }
    .application-form label {
      display: block;
      font-size: 1rem;
      font-weight: 500;
      color: #c8c8c8;
      margin-bottom: 0.5rem;
    }
    .application-form input[type="text"],
    .application-form input[type="email"],
    .application-form input[type="tel"],
    .application-form input[type="password"],
    .application-form select,
    .application-form textarea {
      width: 100%;
      padding: 0.75rem 1rem;
      font-size: 0.95rem;
      border: 1px solid var(--input-border);
      border-radius: 6px;
      background-color: var(--input-bg);
      color: var(--text-light);
      outline: none;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .application-form input:focus,
    .application-form select:focus,
    .application-form textarea:focus {
      border-color: var(--input-focus-border);
      box-shadow: 0 0 8px rgba(216, 67, 21, 0.4);
    }
    .application-form textarea {
      resize: vertical;
      min-height: 100px;
    }

    /* ===== Custom file upload styling ===== */
    .file-input-wrapper {
      position: relative;
      overflow: hidden;
      display: inline-block;
      width: 100%;
      border: 1px solid var(--input-border);
      border-radius: 6px;
      background-color: var(--input-bg);
    }
    .file-input-wrapper input[type="file"] {
      font-size: 0.9rem;
      color: #eee;
      padding: 0.75rem 1rem;
      width: 100%;
      border: none;
      outline: none;
      background: transparent;
      cursor: pointer;
    }
    .file-input-wrapper input[type="file"]::-webkit-file-upload-button {
      visibility: hidden;
    }
    .file-input-wrapper::before {
      content: "Choose PDF";
      display: inline-block;
      background-color: var(--accent);
      color: #fff;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s ease;
      margin-right: 0.5rem;
    }
    .file-input-wrapper:hover::before {
      background-color: var(--accent-light);
    }

    /* ===== Password toggle button ===== */
    .password-wrapper {
      position: relative;
    }
    .password-wrapper input {
      padding-right: 3rem;
    }
    .toggle-password {
      position: absolute;
      top: 50%;
      right: 1rem;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.1rem;
      color: #c8c8c8;
      cursor: pointer;
      transition: color 0.2s;
    }
    .toggle-password:hover {
      color: var(--accent-light);
    }

    /* ===== Checkbox styling ===== */
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1.75rem;
    }
    .checkbox-group input[type="checkbox"] {
      width: 1.1rem;
      height: 1.1rem;
      accent-color: var(--accent-light);
      cursor: pointer;
    }
    .checkbox-group label {
      margin: 0;
      font-size: 0.95rem;
      color: #c8c8c8;
    }

    /* ===== Google Map ===== */
    #map {
      width: 100%;
      height: 300px;
      border-radius: 6px;
      margin-bottom: 1rem;
    }

    /* ===== Submit Button ===== */
    .application-form button[type="submit"] {
      margin-top: 0.5rem;
      font-size: 1rem;
      font-weight: 600;
      padding: 0.85rem 1.5rem;
      border-radius: 6px;
      background: linear-gradient(135deg, var(--accent), var(--accent-light));
      color: #fff;
      border: none;
      width: 100%;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .application-form button[type="submit"]:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
      background: var(--accent-light);
    }

    /* ===== Error & Success Messages ===== */
    .error-message {
      color: #ff6f61;
      font-size: 0.95rem;
      text-align: center;
      margin-top: 1rem;
    }
    .success-message {
      color: #4caf50;
      font-size: 0.95rem;
      text-align: center;
      margin-top: 1rem;
    }

    /* ===== Responsive ===== */
    @media (max-width: 600px) {
      .application-card {
        padding: 1.75rem 1rem;
        margin: 1.5rem 1rem;
      }
      #map {
        height: 250px;
      }
    }
  </style>
</head>
<body>
  <!-- ====== MINI-HERO ====== -->
  <header class="hero mini-hero">
    <div class="hero-overlay"></div>
    <div class="hero-content fade-in">
      <h1 class="hero-title">Apply as a Teacher</h1>
      <p class="hero-subtitle">
        Submit your application, indicate vocational status, and location.
      </p>
    </div>
  </header>

  <!-- ====== APPLICATION FORM CARD ====== -->
  <main class="features-section" style="padding-top: 2rem; padding-bottom: 3rem;">
    <div class="container">
      <div class="application-card">
        <h2>Teacher Application</h2>
        <!-- Note: action points to your Vercel function -->
        <form
          id="teacherApplicationForm"
          class="application-form"
          action="https://tuto-sepia.vercel.app"
          method="POST"
          enctype="multipart/form-data"
          novalidate
        >
          <!-- Full Name -->
          <div class="form-group">
            <label for="teacherFullName">Full Name</label>
            <input
              type="text"
              id="teacherFullName"
              name="fullName"
              placeholder="Jane Smith"
              required
            />
          </div>

          <!-- Email -->
          <div class="form-group">
            <label for="teacherEmail">Email</label>
            <input
              type="email"
              id="teacherEmail"
              name="email"
              placeholder="you@example.com"
              required
            />
          </div>

          <!-- Phone Number -->
          <div class="form-group">
            <label for="teacherPhone">Phone Number</label>
            <input
              type="tel"
              id="teacherPhone"
              name="phone"
              placeholder="+263771234567"
              pattern="^\+?[0-9]{7,15}$"
              required
            />
          </div>

          <!-- Subjects Taught -->
          <div class="form-group">
            <label for="teacherSubjects">Subjects Taught</label>
            <input
              type="text"
              id="teacherSubjects"
              name="subjects"
              placeholder="Math, English, Physics"
              required
            />
            <small style="color: #ccc; font-size: 0.85rem;">
              Comma-separated (e.g., Math, English, Physics)
            </small>
          </div>

          <!-- Highest Qualification -->
          <div class="form-group">
            <label for="teacherQualification">Highest Qualification</label>
            <input
              type="text"
              id="teacherQualification"
              name="qualification"
              placeholder="B.Ed in Secondary Education"
              required
            />
          </div>

          <!-- Vocational Instructor Checkbox -->
          <div class="checkbox-group">
            <input
              type="checkbox"
              id="isVocational"
              name="isVocational"
            />
            <label for="isVocational">
              I am a vocational instructor
            </label>
          </div>

          <!-- Equipment Available Checkbox -->
          <div class="checkbox-group">
            <input
              type="checkbox"
              id="hasEquipment"
              name="hasEquipment"
            />
            <label for="hasEquipment">
              I have the necessary equipment (tools/machines)
            </label>
          </div>

          <!-- Space for ≤5 Learners Checkbox -->
          <div class="checkbox-group">
            <input
              type="checkbox"
              id="hasSmallClassSpace"
              name="hasSmallClassSpace"
            />
            <label for="hasSmallClassSpace">
              I have space to teach up to 5 learners per class
            </label>
          </div>

          <!-- Tell Us About Yourself -->
          <div class="form-group">
            <label for="teacherBio">Tell Us About Yourself</label>
            <textarea
              id="teacherBio"
              name="bio"
              placeholder="A brief bio or cover letter..."
              required
            ></textarea>
          </div>

          <!-- Resume/CV Upload (PDF only) -->
          <div class="form-group">
            <label for="teacherResume">Upload Resume / CV (PDF)</label>
            <div class="file-input-wrapper">
              <input
                type="file"
                id="teacherResume"
                name="resume"
                accept="application/pdf"
                required
              />
            </div>
            <small style="color: #ccc; font-size: 0.85rem;">
              Max file size: 5 MB
            </small>
          </div>

          <!-- Qualification Documents Upload (PDF only) -->
          <div class="form-group">
            <label for="teacherDocs">Upload Qualification Docs (PDF)</label>
            <div class="file-input-wrapper">
              <input
                type="file"
                id="teacherDocs"
                name="docs"
                accept="application/pdf"
                required
              />
            </div>
            <small style="color: #ccc; font-size: 0.85rem;">
              Max file size: 5 MB
            </small>
          </div>

          <!-- Password -->
          <div class="form-group">
            <label for="teacherPassword">Password</label>
            <div class="password-wrapper">
              <input
                type="password"
                id="teacherPassword"
                name="password"
                placeholder="••••••••"
                minlength="6"
                required
              />
              <button
                type="button"
                class="toggle-password"
                aria-label="Show or hide password"
              >
                👁️
              </button>
            </div>
          </div>

          <!-- Confirm Password -->
          <div class="form-group">
            <label for="teacherConfirmPassword">Confirm Password</label>
            <div class="password-wrapper">
              <input
                type="password"
                id="teacherConfirmPassword"
                name="confirmPassword"
                placeholder="••••••••"
                minlength="6"
                required
              />
              <button
                type="button"
                class="toggle-password"
                aria-label="Show or hide password"
              >
                👁️
              </button>
            </div>
          </div>

          <!-- Google Map for Location -->
          <div class="form-group">
            <label for="map">Your Location (Drag marker or click to set)</label>
            <div id="map"></div>
            <!-- Hidden inputs to store lat & lng -->
            <input type="hidden" id="teacherLat" name="latitude" />
            <input type="hidden" id="teacherLng" name="longitude" />
          </div>

          <!-- Submit Button -->
          <button type="submit">Submit Application</button>

          <!-- Already Applied/Login Link -->
          <p style="text-align: center; margin-top: 1rem; color: #ccc; font-size: 0.9rem;">
            Already applied?  
            <a href="login-teacher.html" class="auth-link">Log in here</a>
          </p>

          <!-- Error & Success Messages -->
          <p id="teacherError" class="error-message"></p>
          <p id="teacherSuccess" class="success-message"></p>
        </form>
      </div>
    </div>
  </main>

  <!-- ====== FOOTER ====== -->
  <footer class="site-footer">
    <div class="footer-content">
      <p>&copy; 2025 Tuto. All rights reserved.</p>
      <ul class="social-links">
        <li><a href="#" aria-label="Twitter">🐦</a></li>
        <li><a href="#" aria-label="Facebook">📘</a></li>
        <li><a href="#" aria-label="Instagram">📸</a></li>
      </ul>
    </div>
  </footer>

  <!-- ====== Google Maps & Submission Logic ====== -->
  <script
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY_HERE&callback=initMap"
    async
    defer
  ></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      let map, marker;

      window.initMap = function () {
        const defaultLocation = { lat: -17.8249, lng: 31.0498 }; // Harare

        map = new google.maps.Map(document.getElementById('map'), {
          center: defaultLocation,
          zoom: 12,
          styles: [], // optional custom styling
        });

        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const userLoc = {
                lat: position.coords.latitude,
                lng: position.coords.longitude,
              };
              map.setCenter(userLoc);
              placeMarker(userLoc);
            },
            () => {
              placeMarker(defaultLocation);
            }
          );
        } else {
          placeMarker(defaultLocation);
        }

        map.addListener('click', (e) => {
          placeMarker(e.latLng);
        });
      };

      function placeMarker(location) {
        if (marker) {
          marker.setPosition(location);
        } else {
          marker = new google.maps.Marker({
            position: location,
            map: map,
            draggable: true,
          });
          marker.addListener('dragend', () => {
            const pos = marker.getPosition();
            updateLatLngInputs(pos.lat(), pos.lng());
          });
        }
        updateLatLngInputs(location.lat, location.lng);
      }

      function updateLatLngInputs(lat, lng) {
        document.getElementById('teacherLat').value = lat;
        document.getElementById('teacherLng').value = lng;
      }

      // Toggle password visibility
      document.querySelectorAll('.toggle-password').forEach((btn) => {
        btn.addEventListener('click', () => {
          const pwdInput = btn.previousElementSibling;
          if (pwdInput.getAttribute('type') === 'password') {
            pwdInput.setAttribute('type', 'text');
            btn.textContent = '🙈';
          } else {
            pwdInput.setAttribute('type', 'password');
            btn.textContent = '👁️';
          }
        });
      });

      // Form submission via Fetch API to Vercel
      const form = document.getElementById('teacherApplicationForm');
      const errorPara = document.getElementById('teacherError');
      const successPara = document.getElementById('teacherSuccess');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        errorPara.textContent = '';
        successPara.textContent = '';

        // Basic HTML5 validation
        if (!form.checkValidity()) {
          form.reportValidity();
          return;
        }

        // Password match check
        const password = document.getElementById('teacherPassword').value;
        const confirmPassword = document.getElementById('teacherConfirmPassword').value;
        if (password !== confirmPassword) {
          errorPara.textContent = 'Passwords do not match.';
          return;
        }

        // Ensure PDFs are selected
        const resumeInput = document.getElementById('teacherResume');
        const docsInput = document.getElementById('teacherDocs');
        if (!resumeInput.files.length) {
          errorPara.textContent = 'Please upload your Resume/CV (PDF).';
          return;
        }
        if (!docsInput.files.length) {
          errorPara.textContent = 'Please upload your Qualification Docs (PDF).';
          return;
        }

        // Validate file types & sizes
        const maxSize = 5 * 1024 * 1024; // 5 MB
        const resumeFile = resumeInput.files[0];
        const docsFile = docsInput.files[0];
        if (resumeFile.type !== 'application/pdf') {
          errorPara.textContent = 'Resume must be a PDF file.';
          return;
        }
        if (resumeFile.size > maxSize) {
          errorPara.textContent = 'Resume file size must be under 5 MB.';
          return;
        }
        if (docsFile.type !== 'application/pdf') {
          errorPara.textContent = 'Qualification docs must be a PDF file.';
          return;
        }
        if (docsFile.size > maxSize) {
          errorPara.textContent = 'Qualification docs file size must be under 5 MB.';
          return;
        }

        // Build FormData
        const formData = new FormData(form);

        try {
          const resp = await fetch(form.action, {
            method: 'POST',
            body: formData,
          });
          const data = await resp.json();
          if (resp.ok && data.success) {
            successPara.textContent = 'Application submitted! We will review your documents and get back to you.';
            form.reset();
            if (marker) {
              marker.setPosition(map.getCenter());
              updateLatLngInputs(map.getCenter().lat(), map.getCenter().lng());
            }
          } else {
            throw new Error(data.error || 'Submission failed.');
          }
        } catch (err) {
          console.error(err);
          errorPara.textContent = 'Oops—something went wrong. Please try again.';
        }
      });
    });
  </script>

  <!-- Eruda for mobile debugging -->
  <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
  <script>eruda.init();</script>
</body>
</html>
